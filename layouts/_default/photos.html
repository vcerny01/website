<!DOCTYPE html>
<html lang="{{.Site.LanguageCode}}">

{{ $link := ( printf "%s%s" "data/gallery/" .Params.data )}}
{{ $data := getJSON $link}}

<head>
    {{partial "meta-head" .}}
    {{partial "default-style.html" .}}
    <link rel='stylesheet' type='text/css' href="/css/photos.css">
    {{partial "favicon.html" .}}
    <title>{{ $data.name}}</title>
    <!-- Gallery specific things -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
	<script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>
</head>

<body>
    <header>
        {{partial "navbar.html" .}}
        <h1>{{ .Params.title }}</h1>
        {{partial "date.html" .}}
    </header>
    <section>
        {{.Content}}
    </section>
    		
	 <article>
		{{$path := (printf "%s%s" "static/images/gallery/" $data.dir)}}
		{{range (readDir $path) }}
			{{$name := .Name}}
			{{$filename := printf "%s/%s" (replace $path "static" "") .Name}}
			{{$desc := ""}}
			{{$name = (replace $name ".jpg" "")}}
			{{range $data.descriptions}}
				{{range $ek, $ev := .}}
					{{if eq $ek $name}}
						{{$desc = $ev}}
					{{end}}
				{{end}}
			{{end}}
				<div class="gallery">
					<a href="{{$filename}}" class="glightbox" data-title="{{$name}}. {{$desc}}">
						<img src="{{$filename}}" alt="{{$desc}}">
					</a>
				</div>
		{{end}}
	</article>
    <script>
    	const lightbox = GLightbox({
    		touchNavigation: true,
    		loop: false,
    	});
    </script>
</body>
</html>